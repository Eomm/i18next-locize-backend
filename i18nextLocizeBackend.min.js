!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).i18nextLocizeBackend=t()}(function(){return function n(i,r,s){function a(e,t){if(!r[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(c)return c(e,!0);throw(o=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",o}o=r[e]={exports:{}},i[e][0].call(o.exports,function(t){return a(i[e][1][t]||t)},o,o.exports,n,i,r,s)}return r[e].exports}for(var c="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(o,n,i){!function(e){!function(){var t;"function"==typeof fetch&&(void 0!==e&&e.fetch?t=e.fetch:"undefined"!=typeof window&&window.fetch&&(t=window.fetch)),void 0===o||"undefined"!=typeof window&&void 0!==window.document||((t=t||o("cross-fetch")).default&&(t=t.default),i.default=t,n.exports=i.default)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cross-fetch":5}],2:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n,d=t("./utils.js"),l=(n=t("./request.js"))&&n.__esModule?n:{default:n};function i(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}try{var c="undefined"!=typeof window&&null!==window.localStorage,r="notExistingLocizeProject";window.localStorage.setItem(r,"foo"),window.localStorage.removeItem(r)}catch(t){c=!1}var s,a,u,r=(s=f,(a=[{key:"init",value:function(t){var o,e,n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=3<arguments.length?arguments[3]:void 0;this.services=t,void 0!==i.whitelistThreshold&&void 0===i.translatedPercentageThreshold&&(t&&t.logger&&t.logger.deprecate("whitelistThreshold",'option "whitelistThreshold" will be renamed to "translatedPercentageThreshold" in the next major - please make sure to rename this option asap.'),i.translatedPercentageThreshold=i.whitelistThreshold),this.options=(0,d.defaults)(i,this.options||{},{loadPath:"https://api.locize.app/{{projectId}}/{{version}}/{{lng}}/{{ns}}",privatePath:"https://api.locize.app/private/{{projectId}}/{{version}}/{{lng}}/{{ns}}",getLanguagesPath:"https://api.locize.app/languages/{{projectId}}",addPath:"https://api.locize.app/missing/{{projectId}}/{{version}}/{{lng}}/{{ns}}",updatePath:"https://api.locize.app/update/{{projectId}}/{{version}}/{{lng}}/{{ns}}",referenceLng:"en",crossDomain:!0,setContentTypeJSON:!1,version:"latest",private:!1,translatedPercentageThreshold:.9,whitelistThreshold:.9,failLoadingOnEmptyJSON:!1,allowedAddOrUpdateHosts:["localhost"],onSaved:!1,reloadInterval:"undefined"==typeof window&&36e5,checkForProjectTimeout:3e3,storageExpiration:36e5}),this.allOptions=r,this.somethingLoaded=!1,this.isProjectNotExisting=!1,this.storage=(o=this.options.storageExpiration,e=function(){},a=function(){},c?(e=function(t){window.localStorage.setItem("notExistingLocizeProject_".concat(t),Date.now())},a=function(t){var e=window.localStorage.getItem("notExistingLocizeProject_".concat(t));return!!e&&(!(Date.now()-e>o)||(window.localStorage.removeItem("notExistingLocizeProject_".concat(t)),!1))}):"undefined"!=typeof document&&(e=function(t){var e=new Date;e.setTime(e.getTime()+o);e="; expires=".concat(e.toGMTString()),t="notExistingLocizeProject_".concat(t);document.cookie="".concat(t,"=").concat(Date.now()).concat(e,";path=/")},a=function(t){for(var t="notExistingLocizeProject_".concat(t),e="".concat(t,"="),o=document.cookie.split(";"),n=0;n<o.length;n++){for(var i=o[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return!0}return!1}),{setProjectNotExisting:e,isProjectNotExisting:a}),this.options.pull&&console.warn('The pull API was removed use "private: true" option instead: https://docs.locize.com/integration/api#fetch-private-namespace-resources');var a="undefined"!=typeof window&&window.location&&window.location.hostname;a?(this.isAddOrUpdateAllowed="function"==typeof this.options.allowedAddOrUpdateHosts?this.options.allowedAddOrUpdateHosts(a):-1<this.options.allowedAddOrUpdateHosts.indexOf(a),t&&t.logger&&(r.saveMissing||r.updateMissing)&&(this.isAddOrUpdateAllowed?"localhost"!==a&&t.logger.warn('locize-backend: you are using the save or update missings feature from this host "'.concat(a,'".\nMake sure you will not use it in production!\nhttps://docs.locize.com/guides-tips-and-tricks/going-production')):t.logger.warn("function"==typeof this.options.allowedAddOrUpdateHosts?'locize-backend: will not save or update missings because allowedAddOrUpdateHosts returned false for the host "'.concat(a,'".'):'locize-backend: will not save or update missings because the host "'.concat(a,'" was not in the list of allowedAddOrUpdateHosts: ').concat(this.options.allowedAddOrUpdateHosts.join(", ")," (matches need to be exact).")))):this.isAddOrUpdateAllowed=!0,"function"==typeof s&&this.getOptions(function(t,e){return t?s(t):(n.options.referenceLng=i.referenceLng||e.referenceLng||n.options.referenceLng,void s(null,e))}),this.queuedWrites={pending:{}},this.debouncedProcess=(0,d.debounce)(this.process,1e4),this.interval&&clearInterval(this.interval),this.options.reloadInterval&&this.options.projectId&&(this.interval=setInterval(function(){return n.reload()},this.options.reloadInterval))}},{key:"reload",value:function(){var t,e,o=this,n=this.services,i=n.backendConnector,r=n.languageUtils,s=n.logger;i&&((t=i.language)&&"cimode"===t.toLowerCase()||(e=[],(n=function(t){r.toResolveHierarchy(t).forEach(function(t){e.indexOf(t)<0&&e.push(t)})})(t),this.allOptions.preload&&this.allOptions.preload.forEach(n),e.forEach(function(n){o.allOptions.ns.forEach(function(o){i.read(n,o,"read",null,null,function(t,e){t&&s.warn("loading namespace ".concat(o," for language ").concat(n," failed"),t),!t&&e&&s.log("loaded namespace ".concat(o," for language ").concat(n),e),i.loaded("".concat(n,"|").concat(o),t,e)})})})))}},{key:"getLanguages",value:function(n){var i=this,t=(0,d.isMissingOption)(this.options,["projectId"]);if(t)return n(new Error(t));t=(0,d.interpolate)(this.options.getLanguagesPath,{projectId:this.options.projectId});if(!this.isProjectNotExisting&&this.storage.isProjectNotExisting(this.options.projectId)&&(this.isProjectNotExisting=!0),this.isProjectNotExisting)return n(new Error("locize project ".concat(this.options.projectId," does not exist!")));this.loadUrl({},t,function(t,e,o){return!i.somethingLoaded&&o&&o.resourceNotExisting?(i.isProjectNotExisting=!0,i.storage.setProjectNotExisting(i.options.projectId),n(new Error("locize project ".concat(i.options.projectId," does not exist!")))):(i.somethingLoaded=!0,void n(t,e))})}},{key:"getOptions",value:function(i){var r=this;this.getLanguages(function(t,n){if(t)return i(t);var e=Object.keys(n);if(!e.length)return i(new Error("was unable to load languages via API"));var o=e.reduce(function(t,e){return t=n[e].isReferenceLanguage?e:t},""),t=e.reduce(function(t,e){var o=n[e];return o.translated[r.options.version]&&o.translated[r.options.version]>=r.options.translatedPercentageThreshold&&t.push(e),t},[]),e=e.reduce(function(t,e){return-1<e.indexOf("-")||t},!1);i(null,{fallbackLng:o,referenceLng:o,supportedLngs:t,whitelist:t,load:e?"all":"languageOnly"})})}},{key:"checkIfProjectExists",value:function(e){var t=this,o=this.services.logger;this.somethingLoaded?e&&e(null):this.alreadyRequestedCheckIfProjectExists?setTimeout(function(){return t.checkIfProjectExists(e)},this.options.checkForProjectTimeout):(this.alreadyRequestedCheckIfProjectExists=!0,this.getLanguages(function(t){t&&t.message&&0<t.message.indexOf("does not exist")&&o&&o.error(t.message),e&&e(t)}))}},{key:"read",value:function(t,e,n){var o,i=this,r=(this.services||{logger:console}).logger,s={};if(this.options.private){var a=(0,d.isMissingOption)(this.options,["projectId","version","apiKey"]);if(a)return n(new Error(a),!1);o=(0,d.interpolate)(this.options.privatePath,{lng:t,ns:e,projectId:this.options.projectId,version:this.options.version}),s={authorize:!0}}else{a=(0,d.isMissingOption)(this.options,["projectId","version"]);if(a)return n(new Error(a),!1);o=(0,d.interpolate)(this.options.loadPath,{lng:t,ns:e,projectId:this.options.projectId,version:this.options.version})}if(!this.isProjectNotExisting&&this.storage.isProjectNotExisting(this.options.projectId)&&(this.isProjectNotExisting=!0),this.isProjectNotExisting){e=new Error("locize project ".concat(this.options.projectId," does not exist!"));return r&&r.error(e.message),void(n&&n(e))}this.loadUrl(s,o,function(t,e,o){i.somethingLoaded||(o&&o.resourceNotExisting?setTimeout(function(){return i.checkIfProjectExists()},i.options.checkForProjectTimeout):i.somethingLoaded=!0),n(t,e)})}},{key:"loadUrl",value:function(t,r,e,s){var a=this;t=(0,d.defaults)(t,this.options),"function"==typeof e&&(s=e,e=void 0),s=s||function(){},(0,l.default)(t,r,e,function(t,e){var o,n,i=e&&e.resourceNotExisting;if(e&&(408===e.status||400===e.status))return s("failed loading "+r,!0,{resourceNotExisting:i});if(e&&(500<=e.status&&e.status<600||!e.status))return s("failed loading "+r,!0,{resourceNotExisting:i});if(e&&400<=e.status&&e.status<500)return s("failed loading "+r,!1,{resourceNotExisting:i});if(!e&&t&&t.message&&-1<t.message.indexOf("Failed to fetch"))return s("failed loading "+r,!0,{resourceNotExisting:i});if(t)return s(t,!1);try{o=JSON.parse(e.data)}catch(t){n="failed parsing "+r+" to json"}return n?s(n,!1):a.options.failLoadingOnEmptyJSON&&!Object.keys(o).length?s("loaded result empty for "+r,!1,{resourceNotExisting:i}):void s(null,o,{resourceNotExisting:i})})}},{key:"create",value:function(e,o,n,i,r,s){var a=this;r=r||function(){},this.checkIfProjectExists(function(t){if(t)return r(t);t=(0,d.isMissingOption)(a.options,["projectId","version","apiKey","referenceLng"]);return t?r(new Error(t)):a.isAddOrUpdateAllowed?((e="string"==typeof e?[e]:e).filter(function(t){return t===a.options.referenceLng}).length<1&&a.services&&a.services.logger&&a.services.logger.warn('locize-backend: will not save missings because the reference language "'.concat(a.options.referenceLng,'" was not in the list of to save languages: ').concat(e.join(", ")," (open your site in the reference language to save missings).")),void e.forEach(function(t){t===a.options.referenceLng&&a.queue.call(a,a.options.referenceLng,o,n,i,r,s)})):r("host is not allowed to create key.")})}},{key:"update",value:function(e,o,n,i,r,s){var a=this;r=r||function(){},this.checkIfProjectExists(function(t){if(t)return r(t);t=(0,d.isMissingOption)(a.options,["projectId","version","apiKey","referenceLng"]);return t?r(new Error(t)):a.isAddOrUpdateAllowed?("string"==typeof e&&(e=[e]),(s=s||{}).isUpdate=!0,void e.forEach(function(t){t===a.options.referenceLng&&a.queue.call(a,a.options.referenceLng,o,n,i,r,s)})):r("host is not allowed to update key.")})}},{key:"writePage",value:function(t,e,o,n){var i=(0,d.interpolate)(this.options.addPath,{lng:t,ns:e,projectId:this.options.projectId,version:this.options.version}),e=(0,d.interpolate)(this.options.updatePath,{lng:t,ns:e,projectId:this.options.projectId,version:this.options.version}),r=!1,s=!1,a={},c={};o.forEach(function(t){var e=t.options&&t.options.tDescription?{value:t.fallbackValue||"",context:{text:t.options.tDescription}}:t.fallbackValue||"";t.options&&t.options.isUpdate?(s=s||!0,c[t.key]=e):(r=r||!0,a[t.key]=e)});var u=0;r&&u++,s&&u++;o=function(t){--u||n(t)};u||o(),r&&(0,l.default)((0,d.defaults)({authorize:!0},this.options),i,a,o),s&&(0,l.default)((0,d.defaults)({authorize:!0},this.options),e,c,o)}},{key:"write",value:function(i,r){var s,a=this;(0,d.getPath)(this.queuedWrites,["locks",i,r])||(s=(0,d.getPath)(this.queuedWrites,[i,r]),(0,d.setPath)(this.queuedWrites,[i,r],[]),s.length&&function(){(0,d.setPath)(a.queuedWrites,["locks",i,r],!0);function t(){(0,d.setPath)(a.queuedWrites,["locks",i,r],!1),s.forEach(function(t){t.callback&&t.callback()}),a.options.onSaved&&a.options.onSaved(i,r),a.debouncedProcess(i,r)}var e=s.length/1e3,o=0,n=s.splice(0,1e3);for(a.writePage(i,r,n,function(){e<=++o&&t()});1e3===n.length;)(n=s.splice(0,1e3)).length&&a.writePage(i,r,n,function(){e<=++o&&t()})}())}},{key:"process",value:function(){var o=this;Object.keys(this.queuedWrites).forEach(function(e){"locks"!==e&&Object.keys(o.queuedWrites[e]).forEach(function(t){o.queuedWrites[e][t].length&&o.write(e,t)})})}},{key:"queue",value:function(t,e,o,n,i,r){(0,d.pushPath)(this.queuedWrites,[t,e],{key:o,fallbackValue:n||"",callback:i,options:r}),this.debouncedProcess()}}])&&i(s.prototype,a),u&&i(s,u),f);function f(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=3<arguments.length?arguments[3]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),this.services=t,this.options=e,this.allOptions=o,this.type="backend",t&&t.projectId?this.init(null,t,o,e):this.init(t,e,o,n)}r.type="backend",o.default=r,e.exports=o.default},{"./request.js":3,"./utils.js":4}],3:[function(o,n,i){!function(e){!function(){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a,c,u,t=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==d(t)&&"function"!=typeof t)return{default:t};e=s(e);if(e&&e.has(t))return e.get(t);var o,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(o in t){var r;"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&((r=i?Object.getOwnPropertyDescriptor(t,o):null)&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=t[o])}n.default=t,e&&e.set(t,n);return n}(o("./getFetch.js"));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,o=new WeakMap;return(s=function(t){return t?o:e})(t)}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}"function"==typeof fetch&&(void 0!==e&&e.fetch?a=e.fetch:"undefined"!=typeof window&&window.fetch&&(a=window.fetch)),"function"!=typeof XMLHttpRequest&&"object"!==("undefined"==typeof XMLHttpRequest?"undefined":d(XMLHttpRequest))||(void 0!==e&&e.XMLHttpRequest?c=e.XMLHttpRequest:"undefined"!=typeof window&&window.XMLHttpRequest&&(c=window.XMLHttpRequest)),"function"==typeof ActiveXObject&&(void 0!==e&&e.ActiveXObject?u=e.ActiveXObject:"undefined"!=typeof window&&window.ActiveXObject&&(u=window.ActiveXObject)),"function"!=typeof(a=!a&&t&&!c&&!u?t.default||t:a)&&(a=void 0);i.default=function(t,e,o,n){return"function"==typeof o&&(n=o,o=void 0),n=n||function(){},a?(i=t,s=n,void a(e,{method:(r=o)?"POST":"GET",body:r?JSON.stringify(r):void 0,headers:{Authorization:i.authorize&&i.apiKey?i.apiKey:void 0,"Content-Type":"application/json"}}).then(function(e){var o=e.headers&&"Error from cloudfront"===e.headers.get("x-cache");if(!e.ok)return s(e.statusText||"Error",{status:e.status,resourceNotExisting:o});e.text().then(function(t){s(null,{status:e.status,data:t,resourceNotExisting:o})}).catch(s)}).catch(s)):"function"==typeof XMLHttpRequest||"object"===("undefined"==typeof XMLHttpRequest?"undefined":d(XMLHttpRequest))||"function"==typeof ActiveXObject?function(t,e,o,n){try{var i=c?new c:new u("MSXML2.XMLHTTP.3.0");i.open(o?"POST":"GET",e,1),t.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.authorize&&t.apiKey&&i.setRequestHeader("Authorization",t.apiKey),(o||t.setContentTypeJSON)&&i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){var t="Error from cloudfront"===i.getResponseHeader("x-cache");3<i.readyState&&n(400<=i.status?i.statusText:null,{status:i.status,data:i.responseText,resourceNotExisting:t})},i.send(JSON.stringify(o))}catch(t){console&&console.log(t)}}(t,e,o,n):void 0;var i,r,s},n.exports=i.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./getFetch.js":1}],4:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.defaults=function(o){return n.call(i.call(arguments,1),function(t){if(t)for(var e in t)void 0===o[e]&&(o[e]=t[e])}),o},o.debounce=function(n,i,r){var s;return function(){var t=this,e=arguments,o=r&&!s;clearTimeout(s),s=setTimeout(function(){s=null,r||n.apply(t,e)},i),o&&n.apply(t,e)}},o.setPath=function(t,e,o){t=r(t,e,Object),e=t.obj,t=t.k;e[t]=o},o.pushPath=function(t,e,o,n){t=r(t,e,Object),e=t.obj,t=t.k;e[t]=e[t]||[],n&&(e[t]=e[t].concat(o));n||e[t].push(o)},o.getPath=function(t,e){t=r(t,e),e=t.obj,t=t.k;return e?e[t]:void 0},o.interpolate=function(t,e,o){var n,i;for(;n=s.exec(t);)i=(i=(i="string"!=typeof(i=n[1].trim())?function(t){return null==t?"":""+t}(i):i)||"").replace(/\$/g,"$$$$"),t=t.replace(n[0],e[i]||i),s.lastIndex=0;return t},o.isMissingOption=a,o.optionExist=function(t,e){return!a(t,e)};var o=[],n=o.forEach,i=o.slice;function r(t,e,o){function n(t){return t&&-1<t.indexOf("###")?t.replace(/###/g,"."):t}for(var i="string"!=typeof e?[].concat(e):e.split(".");1<i.length;){if(!t)return{};var r=n(i.shift());!t[r]&&o&&(t[r]=new o),t=t[r]}return t?{obj:t,k:n(i.shift())}:{}}var s=new RegExp("{{(.+?)}}","g");function a(o,t){return t.reduce(function(t,e){if(t)return t;if(o&&o[e]&&"string"==typeof o[e]&&!o[e].toLowerCase()!==e.toLowerCase())return!1;e='i18next-locize-backend :: got "'.concat(o[e],'" in options for ').concat(e," which is invalid.");return console.warn(e),e},!1)}},{}],5:[function(t,e,o){var x,n="undefined"!=typeof self?self:this,i=(r.prototype=n,new r);function r(){this.fetch=!1,this.DOMException=n.DOMException}x=i,function(a){var e,o,n="URLSearchParams"in x,i="Symbol"in x&&"iterator"in Symbol,c="FileReader"in x&&"Blob"in x&&function(){try{return new Blob,!0}catch(t){return!1}}(),r="FormData"in x,s="ArrayBuffer"in x;function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function d(t){return t="string"!=typeof t?String(t):t}function t(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(o){return new Promise(function(t,e){o.onload=function(){t(o.result)},o.onerror=function(){e(o.error)}})}function h(t){var e=new FileReader,o=p(e);return e.readAsArrayBuffer(t),o}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(t){var e;(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:c&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:r&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&c&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||o(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var t,e,o=f(this);if(o)return o;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,o=p(e),e.readAsText(t),o;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),o=new Array(e.length),n=0;n<e.length;n++)o[n]=String.fromCharCode(e[n]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}s&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),l.prototype.append=function(t,e){t=u(t),e=d(e);var o=this.map[t];this.map[t]=o?o+", "+e:e},l.prototype.delete=function(t){delete this.map[u(t)]},l.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},l.prototype.set=function(t,e){this.map[u(t)]=d(e)},l.prototype.forEach=function(t,e){for(var o in this.map)this.map.hasOwnProperty(o)&&t.call(e,this.map[o],o,this)},l.prototype.keys=function(){var o=[];return this.forEach(function(t,e){o.push(e)}),t(o)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),t(e)},l.prototype.entries=function(){var o=[];return this.forEach(function(t,e){o.push([e,t])}),t(o)},i&&(l.prototype[Symbol.iterator]=l.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var o,n=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=(o=e.method||this.method||"GET",t=o.toUpperCase(),-1<v.indexOf(t)?t:o),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function b(t){var o=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(t=(e=t.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),o.append(decodeURIComponent(t),decodeURIComponent(e)))}),o}function m(t,e){e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},g.call(w.prototype),g.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},m.error=function(){var t=new m(null,{status:0,statusText:""});return t.type="error",t};var j=[301,302,303,307,308];m.redirect=function(t,e){if(-1===j.indexOf(e))throw new RangeError("Invalid status code");return new m(null,{status:e,headers:{location:t}})},a.DOMException=x.DOMException;try{new a.DOMException}catch(t){a.DOMException=function(t,e){this.message=t,this.name=e;t=Error(t);this.stack=t.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function E(r,s){return new Promise(function(n,t){var e=new w(r,s);if(e.signal&&e.signal.aborted)return t(new a.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function o(){i.abort()}i.onload=function(){var o,t={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",o=new l,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var e=t.split(":"),t=e.shift().trim();t&&(e=e.join(":").trim(),o.append(t,e))}),o)};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;n(new m(e,t))},i.onerror=function(){t(new TypeError("Network request failed"))},i.ontimeout=function(){t(new TypeError("Network request failed"))},i.onabort=function(){t(new a.DOMException("Aborted","AbortError"))},i.open(e.method,e.url,!0),"include"===e.credentials?i.withCredentials=!0:"omit"===e.credentials&&(i.withCredentials=!1),"responseType"in i&&c&&(i.responseType="blob"),e.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),e.signal&&(e.signal.addEventListener("abort",o),i.onreadystatechange=function(){4===i.readyState&&e.signal.removeEventListener("abort",o)}),i.send(void 0===e._bodyInit?null:e._bodyInit)})}E.polyfill=!0,x.fetch||(x.fetch=E,x.Headers=l,x.Request=w,x.Response=m),a.Headers=l,a.Request=w,a.Response=m,a.fetch=E,Object.defineProperty(a,"__esModule",{value:!0})}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;(o=i.fetch).default=i.fetch,o.fetch=i.fetch,o.Headers=i.Headers,o.Request=i.Request,o.Response=i.Response,e.exports=o},{}]},{},[2])(2)});